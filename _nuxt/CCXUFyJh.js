import{m as P,j as T,h as F,c as J}from"./DVdCqbPO.js";import{p as _,k,q as G,a as V,b as Z,c as X}from"./xORCdWPW.js";import{z as Q,m as ee,A as te,B as E,C as ne,D as re,E as oe,G as ie,b as z,H as se,I as ae}from"./D-Dwnp2u.js";import{j as ce}from"./DqNmVOr0.js";import"./D3VNWYyd.js";function A(e,n=50,i=20){return new Promise((c,l)=>{B(e,m=>{m?l(m):c(!0)},n,i)})}function B(e,n,i=50,c=20){if(e())return n(void 0);setTimeout(()=>{B(e,n,i,c-1)},i),c===0&&n(new Error("Max tries reached"))}function ue(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j={exports:{}},le=j.exports,K;function de(){return K||(K=1,(function(e,n){(function(i,c,l){e.exports=l(),e.exports.default=l()})("slugify",le,function(){var i=JSON.parse(`{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","¢":"cent","£":"pound","¤":"currency","¥":"yen","©":"(c)","ª":"a","®":"(r)","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"DJ","đ":"dj","Ē":"E","ē":"e","Ė":"E","ė":"e","Ę":"e","ę":"e","Ě":"E","ě":"e","Ğ":"G","ğ":"g","Ģ":"G","ģ":"g","Ĩ":"I","ĩ":"i","Ī":"i","ī":"i","Į":"I","į":"i","İ":"I","ı":"i","Ķ":"k","ķ":"k","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","Ō":"O","ō":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ũ":"U","ũ":"u","Ū":"u","ū":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","Ə":"E","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","ǈ":"LJ","ǉ":"lj","ǋ":"NJ","ǌ":"nj","Ș":"S","ș":"s","Ț":"T","ț":"t","ə":"e","˚":"o","Ά":"A","Έ":"E","Ή":"H","Ί":"I","Ό":"O","Ύ":"Y","Ώ":"W","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ϊ":"I","Ϋ":"Y","ά":"a","έ":"e","ή":"h","ί":"i","ΰ":"y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","ς":"s","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ϊ":"i","ϋ":"y","ό":"o","ύ":"y","ώ":"w","Ё":"Yo","Ђ":"DJ","Є":"Ye","І":"I","Ї":"Yi","Ј":"J","Љ":"LJ","Њ":"NJ","Ћ":"C","Џ":"DZ","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","ё":"yo","ђ":"dj","є":"ye","і":"i","ї":"yi","ј":"j","љ":"lj","њ":"nj","ћ":"c","ѝ":"u","џ":"dz","Ґ":"G","ґ":"g","Ғ":"GH","ғ":"gh","Қ":"KH","қ":"kh","Ң":"NG","ң":"ng","Ү":"UE","ү":"ue","Ұ":"U","ұ":"u","Һ":"H","һ":"h","Ә":"AE","ә":"ae","Ө":"OE","ө":"oe","Ա":"A","Բ":"B","Գ":"G","Դ":"D","Ե":"E","Զ":"Z","Է":"E'","Ը":"Y'","Թ":"T'","Ժ":"JH","Ի":"I","Լ":"L","Խ":"X","Ծ":"C'","Կ":"K","Հ":"H","Ձ":"D'","Ղ":"GH","Ճ":"TW","Մ":"M","Յ":"Y","Ն":"N","Շ":"SH","Չ":"CH","Պ":"P","Ջ":"J","Ռ":"R'","Ս":"S","Վ":"V","Տ":"T","Ր":"R","Ց":"C","Փ":"P'","Ք":"Q'","Օ":"O''","Ֆ":"F","և":"EV","ء":"a","آ":"aa","أ":"a","ؤ":"u","إ":"i","ئ":"e","ا":"a","ب":"b","ة":"h","ت":"t","ث":"th","ج":"j","ح":"h","خ":"kh","د":"d","ذ":"th","ر":"r","ز":"z","س":"s","ش":"sh","ص":"s","ض":"dh","ط":"t","ظ":"z","ع":"a","غ":"gh","ف":"f","ق":"q","ك":"k","ل":"l","م":"m","ن":"n","ه":"h","و":"w","ى":"a","ي":"y","ً":"an","ٌ":"on","ٍ":"en","َ":"a","ُ":"u","ِ":"e","ْ":"","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","پ":"p","چ":"ch","ژ":"zh","ک":"k","گ":"g","ی":"y","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","฿":"baht","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"f","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","Ṣ":"S","ṣ":"s","Ẁ":"W","ẁ":"w","Ẃ":"W","ẃ":"w","Ẅ":"W","ẅ":"w","ẞ":"SS","Ạ":"A","ạ":"a","Ả":"A","ả":"a","Ấ":"A","ấ":"a","Ầ":"A","ầ":"a","Ẩ":"A","ẩ":"a","Ẫ":"A","ẫ":"a","Ậ":"A","ậ":"a","Ắ":"A","ắ":"a","Ằ":"A","ằ":"a","Ẳ":"A","ẳ":"a","Ẵ":"A","ẵ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ẻ":"E","ẻ":"e","Ẽ":"E","ẽ":"e","Ế":"E","ế":"e","Ề":"E","ề":"e","Ể":"E","ể":"e","Ễ":"E","ễ":"e","Ệ":"E","ệ":"e","Ỉ":"I","ỉ":"i","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ỏ":"O","ỏ":"o","Ố":"O","ố":"o","Ồ":"O","ồ":"o","Ổ":"O","ổ":"o","Ỗ":"O","ỗ":"o","Ộ":"O","ộ":"o","Ớ":"O","ớ":"o","Ờ":"O","ờ":"o","Ở":"O","ở":"o","Ỡ":"O","ỡ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ủ":"U","ủ":"u","Ứ":"U","ứ":"u","Ừ":"U","ừ":"u","Ử":"U","ử":"u","Ữ":"U","ữ":"u","Ự":"U","ự":"u","Ỳ":"Y","ỳ":"y","Ỵ":"Y","ỵ":"y","Ỷ":"Y","ỷ":"y","Ỹ":"Y","ỹ":"y","–":"-","‘":"'","’":"'","“":"\\"","”":"\\"","„":"\\"","†":"+","•":"*","…":"...","₠":"ecu","₢":"cruzeiro","₣":"french franc","₤":"lira","₥":"mill","₦":"naira","₧":"peseta","₨":"rupee","₩":"won","₪":"new shequel","₫":"dong","€":"euro","₭":"kip","₮":"tugrik","₯":"drachma","₰":"penny","₱":"peso","₲":"guarani","₳":"austral","₴":"hryvnia","₵":"cedi","₸":"kazakhstani tenge","₹":"indian rupee","₺":"turkish lira","₽":"russian ruble","₿":"bitcoin","℠":"sm","™":"tm","∂":"d","∆":"delta","∑":"sum","∞":"infinity","♥":"love","元":"yuan","円":"yen","﷼":"rial","ﻵ":"laa","ﻷ":"laa","ﻹ":"lai","ﻻ":"la"}`),c=JSON.parse('{"bg":{"Й":"Y","Ц":"Ts","Щ":"Sht","Ъ":"A","Ь":"Y","й":"y","ц":"ts","щ":"sht","ъ":"a","ь":"y"},"de":{"Ä":"AE","ä":"ae","Ö":"OE","ö":"oe","Ü":"UE","ü":"ue","ß":"ss","%":"prozent","&":"und","|":"oder","∑":"summe","∞":"unendlich","♥":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","¢":"centavos","£":"libras","¤":"moneda","₣":"francos","∑":"suma","∞":"infinito","♥":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","¢":"centime","£":"livre","¤":"devise","₣":"franc","∑":"somme","∞":"infini","♥":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","¢":"centavo","∑":"soma","£":"libra","∞":"infinito","♥":"amor"},"uk":{"И":"Y","и":"y","Й":"Y","й":"y","Ц":"Ts","ц":"ts","Х":"Kh","х":"kh","Щ":"Shch","щ":"shch","Г":"H","г":"h"},"vi":{"Đ":"D","đ":"d"},"da":{"Ø":"OE","ø":"oe","Å":"AA","å":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"større end"},"nb":{"&":"og","Å":"AA","Æ":"AE","Ø":"OE","å":"aa","æ":"ae","ø":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","Å":"AA","Ä":"AE","Ö":"OE","å":"aa","ä":"ae","ö":"oe"}}');function l(m,d){if(typeof m!="string")throw new Error("slugify: string argument expected");d=typeof d=="string"?{replacement:d}:d||{};var p=c[d.locale]||{},h=d.replacement===void 0?"-":d.replacement,t=d.trim===void 0?!0:d.trim,r=m.normalize().split("").reduce(function(s,a){var o=p[a];return o===void 0&&(o=i[a]),o===void 0&&(o=a),o===h&&(o=" "),s+o.replace(d.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")},"");return d.strict&&(r=r.replace(/[^A-Za-z0-9\s]/g,"")),t&&(r=r.trim()),r=r.replace(/\s+/g,h),d.lower&&(r=r.toLowerCase()),r}return l.extend=function(m){Object.assign(i,m)},l})})(j)),j.exports}var fe=de();const me=ue(fe),pe=/^\d+(?:\.\d+)*(?:\.x)?$/,he={slugifyOptions:{lower:!0}};function ge(e,n={}){const i=Q(n,he),{basename:c,extension:l,stem:m}=we(e.id);return{path:ye(m,i),...e,title:e.title||ve(Y(c)),stem:m,extension:l}}const ye=(e,{forceLeadingSlash:n=!0,slugifyOptions:i={}}={})=>(e=e.split("/").map(c=>me(Y(c),i)).join("/"),n?ee(te(e)):e),ve=e=>e.split(/[\s-]/g).map(_).join(" ");function Y(e){return e=e.split(/[/:]/).pop(),pe.test(e)?e:e.replace(/(\d+\.)?(.*)/,"$2").replace(/^index(\.draft)?$/,"").replace(/\.draft$/,"")}const we=e=>{const[n,...i]=e.split(/[:/]/),[,c,l]=i[i.length-1]?.match(/(.*)\.([^.]+)$/)||[];c&&(i[i.length-1]=c);const m=(i||[]).join("/");return{source:n,stem:m,extension:l,basename:c||""}},Ie=(e,n)=>{let i;return Object.values(n).find(l=>!l.source||l.source.length===0?void 0:(e==="/"?["index.yml","index.yaml","index.md","index.json"]:[e]).some(d=>(i=l.source.find(p=>{const h=P(d,p.include,{dot:!0}),t=p.exclude?.some(r=>P(d,r));return h&&!t}),i)))};function Se(e,n){const{fixed:i}=q(n.source[0]),c=e.substring(i.length);return T(n.name,n.source[0]?.prefix||"",c)}function H(e){const n=Object.values(e.definitions)[0]?.properties||{},i=new Set([n.id?"id":void 0,n.title?"title":void 0,...Object.keys(n).sort()].filter(Boolean));return Array.from(i)}function be(e,n){const i=n[e];if(!i)throw new Error(`Collection ${e} not found`);return i}function Oe(e,n){const[i,...c]=e.split(/[/:]/),l=c.join("/");return n.source.find(d=>{const p=P(l,d.include,{dot:!0}),h=d.exclude?.some(t=>P(l,t));return p&&!h})}function Ee(e,n){const[i,...c]=e.split(/[/:]/),l=c.join("/"),{fixed:m}=q(n),d=l.substring(m.length);return T(m,d)}function $(e,n){const i=be(e.split(/[/:]/)[0],n),c=Oe(e,i),l=Ee(e,c);return{collection:i,source:c,fsPath:l}}function q(e){const[n,...i]=e.include.includes("*")?e.include.split("*"):["",e.include];return{fixed:n||"",dynamic:"*"+i.join("*")}}function R(e,n,i){const c=[ge].reduce((p,h)=>e.type==="page"?h(p):p,{...i,id:n}),l={id:n},m=c.meta,d=H(e.schema);for(const p of Object.keys(c))d.includes(p)?l[p]=c[p]:m[p]=c[p];if(l.meta=m,d.includes("seo")){const p=l.seo=l.seo||{};p.title=p.title||l.title,p.description=p.description||l.description}return l}function Ae(e){if(e?.seo){const n=e.seo;(!n.title||n.title===e.title)&&Reflect.deleteProperty(e.seo,"title"),(!n.description||n.description===e.description)&&Reflect.deleteProperty(e.seo,"description"),Object.keys(n).length===0&&Reflect.deleteProperty(e,"seo")}return e}function xe(e,n){const i=[],c=e.schema.definitions[e.name].properties;return H(e.schema).forEach(m=>{const d=c[m],p=e.fields[m],h=d?.default!==void 0?d.default:"NULL",t=typeof n[m]<"u"?n[m]:h;p==="json"?i.push(`'${JSON.stringify(t).replace(/'/g,"''")}'`):p==="string"||["string","enum"].includes(d.type)?["data","datetime"].includes(d.format)?i.push(t!=="NULL"?`'${new Date(t).toISOString()}'`:h):i.push(`'${String(t).replace(/\n/g,"\\n").replace(/'/g,"''")}'`):p==="boolean"?i.push(t!=="NULL"?!!t:t):i.push(t)}),i.push(`'${F(i)}'`),i}function je(e,n){const i=xe(e,n);let c=0;return`INSERT INTO ${e.tableName} VALUES (${"?, ".repeat(i.length).slice(0,-2)})`.replace(/\?/g,()=>i[c++])}function L(e,n){return`DELETE FROM ${e.tableName} WHERE id = '${n}';`}function Ce(e){return!e||typeof e.then!="function"?Promise.resolve(e):e}function y(e,...n){try{return Ce(e(...n))}catch(i){return Promise.reject(i)}}function Pe(e){const n=typeof e;return e===null||n!=="object"&&n!=="function"}function $e(e){const n=Object.getPrototypeOf(e);return!n||n.isPrototypeOf(Object)}function C(e){if(Pe(e))return String(e);if($e(e)||Array.isArray(e))return JSON.stringify(e);if(typeof e.toJSON=="function")return C(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const M="base64:";function Me(e){return typeof e=="string"?e:M+Re(e)}function De(e){return typeof e!="string"||!e.startsWith(M)?e:Ke(e.slice(M.length))}function Ke(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),n=>n.codePointAt(0))}function Re(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e))}function v(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function Le(...e){return v(e.join(":"))}function x(e){return e=v(e),e?e+":":""}function Ue(e,n){if(n===void 0)return!0;let i=0,c=e.indexOf(":");for(;c>-1;)i++,c=e.indexOf(":",c+1);return i<=n}function Ne(e,n){return n?e.startsWith(n)&&e[e.length-1]!=="$":e[e.length-1]!=="$"}const We="memory",Te=()=>{const e=new Map;return{name:We,getInstance:()=>e,hasItem(n){return e.has(n)},getItem(n){return e.get(n)??null},getItemRaw(n){return e.get(n)??null},setItem(n,i){e.set(n,i)},setItemRaw(n,i){e.set(n,i)},removeItem(n){e.delete(n)},getKeys(){return[...e.keys()]},clear(){e.clear()},dispose(){e.clear()}}};function ze(e={}){const n={mounts:{"":e.driver||Te()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=t=>{for(const r of n.mountpoints)if(t.startsWith(r))return{base:r,relativeKey:t.slice(r.length),driver:n.mounts[r]};return{base:"",relativeKey:t,driver:n.mounts[""]}},c=(t,r)=>n.mountpoints.filter(s=>s.startsWith(t)||r&&t.startsWith(s)).map(s=>({relativeBase:t.length>s.length?t.slice(s.length):void 0,mountpoint:s,driver:n.mounts[s]})),l=(t,r)=>{if(n.watching){r=v(r);for(const s of n.watchListeners)s(t,r)}},m=async()=>{if(!n.watching){n.watching=!0;for(const t in n.mounts)n.unwatch[t]=await U(n.mounts[t],l,t)}},d=async()=>{if(n.watching){for(const t in n.unwatch)await n.unwatch[t]();n.unwatch={},n.watching=!1}},p=(t,r,s)=>{const a=new Map,o=u=>{let f=a.get(u.base);return f||(f={driver:u.driver,base:u.base,items:[]},a.set(u.base,f)),f};for(const u of t){const f=typeof u=="string",g=v(f?u:u.key),w=f?void 0:u.value,S=f||!u.options?r:{...r,...u.options},I=i(g);o(I).items.push({key:g,value:w,relativeKey:I.relativeKey,options:S})}return Promise.all([...a.values()].map(u=>s(u))).then(u=>u.flat())},h={hasItem(t,r={}){t=v(t);const{relativeKey:s,driver:a}=i(t);return y(a.hasItem,s,r)},getItem(t,r={}){t=v(t);const{relativeKey:s,driver:a}=i(t);return y(a.getItem,s,r).then(o=>E(o))},getItems(t,r={}){return p(t,r,s=>s.driver.getItems?y(s.driver.getItems,s.items.map(a=>({key:a.relativeKey,options:a.options})),r).then(a=>a.map(o=>({key:Le(s.base,o.key),value:E(o.value)}))):Promise.all(s.items.map(a=>y(s.driver.getItem,a.relativeKey,a.options).then(o=>({key:a.key,value:E(o)})))))},getItemRaw(t,r={}){t=v(t);const{relativeKey:s,driver:a}=i(t);return a.getItemRaw?y(a.getItemRaw,s,r):y(a.getItem,s,r).then(o=>De(o))},async setItem(t,r,s={}){if(r===void 0)return h.removeItem(t);t=v(t);const{relativeKey:a,driver:o}=i(t);o.setItem&&(await y(o.setItem,a,C(r),s),o.watch||l("update",t))},async setItems(t,r){await p(t,r,async s=>{if(s.driver.setItems)return y(s.driver.setItems,s.items.map(a=>({key:a.relativeKey,value:C(a.value),options:a.options})),r);s.driver.setItem&&await Promise.all(s.items.map(a=>y(s.driver.setItem,a.relativeKey,C(a.value),a.options)))})},async setItemRaw(t,r,s={}){if(r===void 0)return h.removeItem(t,s);t=v(t);const{relativeKey:a,driver:o}=i(t);if(o.setItemRaw)await y(o.setItemRaw,a,r,s);else if(o.setItem)await y(o.setItem,a,Me(r),s);else return;o.watch||l("update",t)},async removeItem(t,r={}){typeof r=="boolean"&&(r={removeMeta:r}),t=v(t);const{relativeKey:s,driver:a}=i(t);a.removeItem&&(await y(a.removeItem,s,r),(r.removeMeta||r.removeMata)&&await y(a.removeItem,s+"$",r),a.watch||l("remove",t))},async getMeta(t,r={}){typeof r=="boolean"&&(r={nativeOnly:r}),t=v(t);const{relativeKey:s,driver:a}=i(t),o=Object.create(null);if(a.getMeta&&Object.assign(o,await y(a.getMeta,s,r)),!r.nativeOnly){const u=await y(a.getItem,s+"$",r).then(f=>E(f));u&&typeof u=="object"&&(typeof u.atime=="string"&&(u.atime=new Date(u.atime)),typeof u.mtime=="string"&&(u.mtime=new Date(u.mtime)),Object.assign(o,u))}return o},setMeta(t,r,s={}){return this.setItem(t+"$",r,s)},removeMeta(t,r={}){return this.removeItem(t+"$",r)},async getKeys(t,r={}){t=x(t);const s=c(t,!0);let a=[];const o=[];let u=!0;for(const g of s){g.driver.flags?.maxDepth||(u=!1);const w=await y(g.driver.getKeys,g.relativeBase,r);for(const S of w){const I=g.mountpoint+v(S);a.some(O=>I.startsWith(O))||o.push(I)}a=[g.mountpoint,...a.filter(S=>!S.startsWith(g.mountpoint))]}const f=r.maxDepth!==void 0&&!u;return o.filter(g=>(!f||Ue(g,r.maxDepth))&&Ne(g,t))},async clear(t,r={}){t=x(t),await Promise.all(c(t,!1).map(async s=>{if(s.driver.clear)return y(s.driver.clear,s.relativeBase,r);if(s.driver.removeItem){const a=await s.driver.getKeys(s.relativeBase||"",r);return Promise.all(a.map(o=>s.driver.removeItem(o,r)))}}))},async dispose(){await Promise.all(Object.values(n.mounts).map(t=>N(t)))},async watch(t){return await m(),n.watchListeners.push(t),async()=>{n.watchListeners=n.watchListeners.filter(r=>r!==t),n.watchListeners.length===0&&await d()}},async unwatch(){n.watchListeners=[],await d()},mount(t,r){if(t=x(t),t&&n.mounts[t])throw new Error(`already mounted at ${t}`);return t&&(n.mountpoints.push(t),n.mountpoints.sort((s,a)=>a.length-s.length)),n.mounts[t]=r,n.watching&&Promise.resolve(U(r,l,t)).then(s=>{n.unwatch[t]=s}).catch(console.error),h},async unmount(t,r=!0){t=x(t),!(!t||!n.mounts[t])&&(n.watching&&t in n.unwatch&&(n.unwatch[t]?.(),delete n.unwatch[t]),r&&await N(n.mounts[t]),n.mountpoints=n.mountpoints.filter(s=>s!==t),delete n.mounts[t])},getMount(t=""){t=v(t)+":";const r=i(t);return{driver:r.driver,base:r.base}},getMounts(t="",r={}){return t=v(t),c(t,r.parents).map(a=>({driver:a.driver,base:a.mountpoint}))},keys:(t,r={})=>h.getKeys(t,r),get:(t,r={})=>h.getItem(t,r),set:(t,r,s={})=>h.setItem(t,r,s),has:(t,r={})=>h.hasItem(t,r),del:(t,r={})=>h.removeItem(t,r),remove:(t,r={})=>h.removeItem(t,r)};return h}function U(e,n,i){return e.watch?e.watch((c,l)=>n(c,i+l)):()=>{}}async function N(e){typeof e.dispose=="function"&&await y(e.dispose)}const D=ze({});D.setItem("public-assets/favicon.ico",{id:"public-assets/favicon.ico",extension:"ico",stem:"favicon.ico",path:"/favicon.ico"});D.setItem("public-assets/robots.txt",{id:"public-assets/robots.txt",extension:"txt",stem:"robots.txt",path:"/robots.txt"});const b=D;function Be(e){return re()?(oe(e),!0):!1}function Ye(e){let n=0,i,c;const l=()=>{n-=1,c&&n<=0&&(c.stop(),i=void 0,c=void 0)};return(...m)=>(n+=1,c||(c=ne(!0),i=c.run(()=>e(...m))),Be(l),i)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const He=Ye(()=>{const e=ie([]),n=z();async function i(){const c=await $fetch("/__nuxt_studio/meta",{headers:{"content-type":"application/json"}}).catch(()=>({components:[]}));e.value=c.components||[]}return{meta:n,fetch:i,componentsMeta:e}}),qe="v0.0.1";function Fe(){let e=440;if(typeof window<"u"&&window.localStorage){const n=localStorage.getItem("studio-sidebar-width");if(n){const i=Number.parseInt(n,10);if(!Number.isNaN(i))return e=i,i}}return e}function Je(){const e=Fe();return{"body[data-studio-active]":{transition:"margin 0.2s ease"},"body[data-studio-active][data-expand-sidebar]":{marginLeft:`${e}px`}}}function W(){return document.documentElement.classList.contains("dark")?"dark":"light"}function Xe(e,n){let i=null,c=W();const l=z(!1),m=He();function d(){return window.useNuxtApp()}function p(){return d().$router}function h(){return{...d().$content||{},queryCollection:X,queryCollectionItemSurroundings:Z,queryCollectionNavigation:V,queryCollectionSearchSections:G,collections:J}}function t(o){return i(o)}function r(){return Object.fromEntries(Object.entries(h().collections).filter(([,o])=>!(!o.source.length||o.source.some(u=>u.repository||u._custom))))}function s(o){return h().queryCollection(o)}const a={meta:{dev:!1,components:()=>m.componentsMeta.value},on:{routeChange:o=>{p()?.afterEach?.((f,g)=>{o(f,g)})},mounted:o=>A(()=>l.value,400).then(o),beforeUnload:o=>{a.ui.deactivateStudio(),A(()=>l.value).then(()=>{window.addEventListener("beforeunload",o)})},colorModeChange:o=>{new MutationObserver(()=>{c=W(),o(c)}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})},manifestUpdate:o=>{d().hooks.hookOnce("app:manifest:update",u=>o(u.id))},documentUpdate:o=>{},mediaUpdate:o=>{}},ui:{colorMode:c,activateStudio:()=>{document.body.setAttribute("data-studio-active","true")},deactivateStudio:()=>{document.body.removeAttribute("data-studio-active"),a.ui.collapseSidebar(),a.ui.updateStyles()},expandSidebar:()=>{document.body.setAttribute("data-expand-sidebar","true"),a.ui.updateStyles()},collapseSidebar:()=>{document.body.removeAttribute("data-expand-sidebar"),a.ui.updateStyles()},updateStyles:()=>{const o=Je(),u=Object.keys(o).map(g=>{if(g==="css")return o.css||"";const w=Object.entries(o[g]).map(([S,I])=>`${k(S)}: ${I}`).join(";");return`${g} { ${w} }`}).join("");let f=document.querySelector("[data-studio-style]");f||(f=document.createElement("style"),f.setAttribute("data-studio-style",""),document.head.appendChild(f)),f.textContent=u}},repository:n,user:{get:()=>e},document:{get:async o=>{const u=await s(o.split("/")[0]).where("id","=",o).first();return Ae(u)},getFileSystemPath:o=>$(o,r()).fsPath,list:async()=>{const o=Object.keys(r()).filter(f=>f!=="info");return(await Promise.all(o.map(async f=>await s(f).all()))).flat()},create:async(o,u)=>{const f=r(),g=Ie(o,f),w=Se(o,g);if(await a.document.get(w))throw new Error(`Cannot create document with id "${w}": document already exists.`);const I=await ce(w,u),O=R(g,w,I);return await a.document.upsert(w,O),O},upsert:async(o,u)=>{o=o.replace(/:/g,"/");const f=$(o,r()).collection,g=R(f,o,u);await t(f.name).exec(L(f,o)),await t(f.name).exec(je(f,g))},delete:async o=>{o=o.replace(/:/g,"/");const u=$(o,r()).collection;await t(u.name).exec(L(u,o))},detectActives:()=>{const o=document.querySelectorAll("[data-content-id]");return Array.from(o).map(u=>{const f=u.getAttribute("data-content-id"),g=f.split(/[/:]/).pop()||f;return{id:f,title:g}})}},media:{get:async o=>await b.getItem(o),getFileSystemPath:o=>o.split("/").slice(1).join("/"),list:async()=>await Promise.all(await b.getKeys().then(o=>o.map(u=>b.getItem(u)))),upsert:async(o,u)=>{await b.setItem(o,u)},delete:async o=>{await b.removeItem(o)}},app:{getManifestId:async()=>(await ae()).id,requestRerender:async()=>{d().payload.error&&await se({redirect:`?t=${Date.now()}`}),d().hooks.callHookParallel("app:data:refresh")},navigateTo:o=>{p().push(o)}}};return(async()=>(a.ui.activateStudio(),A(()=>h().queryCollection!==void 0,500).then(()=>A(()=>h().loadLocalDatabase!==void 0)).then(()=>h().loadLocalDatabase()).then(o=>{i=o,l.value=!0}).then(()=>("serviceWorker"in navigator&&navigator.serviceWorker.register(`/sw.js?${qe}`),m.fetch()))))(),a}export{Xe as useStudioHost};
